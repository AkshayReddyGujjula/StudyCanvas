@tailwind base;
@tailwind components;
@tailwind utilities;

/* StudyCanvas Minimalist Colour Palette
   Primary - Deep Navy: #1E3A5F (Content Nodes)
   Secondary - Soft Teal: #2D9CDB (Answer Nodes)
   Accent - Warm Coral: #EB5757 (Quiz/Struggling)
   Success - Sage Green: #27AE60 (Understood/Flashcards)
   Neutral - Slate: #6B7280 (Text/Icons)
*/

* {
  box-sizing: border-box;
}

html,
body,
#root {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }

  to {
    opacity: 1;
  }
}



/* Override React Flow's global user-select: none and grab cursor inside node text areas */
.react-flow__node .nodrag,
.react-flow__node .nodrag * {
  user-select: text !important;
  -webkit-user-select: text !important;
}

.react-flow__node .nodrag {
  cursor: text !important;
}

/* While a connection is being dragged from a handle, kill text selection everywhere.
   This class is toggled on <body> by onConnectStart / onConnectEnd.
   Higher specificity than .react-flow__node .nodrag * so it wins the !important fight. */
body.rf-connecting .react-flow__node .nodrag,
body.rf-connecting .react-flow__node .nodrag * {
  user-select: none !important;
  -webkit-user-select: none !important;
  cursor: crosshair !important;
}

/* ────────────────────────────────────────────────
   DARK MODE  –  white ↔ black only, colours kept
   ──────────────────────────────────────────────── */

/* Root canvas area */
.dark-mode,
.dark-mode .react-flow__pane,
.dark-mode .react-flow__renderer,
.dark-mode .react-flow__viewport,
.dark-mode .react-flow__container {
  background-color: #0a0a0a !important;
}

/* Background dot pattern */
.dark-mode .react-flow__background {
  background-color: #0a0a0a !important;
}

.dark-mode .react-flow__background pattern circle,
.dark-mode .react-flow__background pattern rect {
  fill: #1e1e1e;
}

/* ReactFlow built-in controls panel — sized buttons */
.react-flow__controls-button {
  width: 36px !important;
  height: 36px !important;
  padding: 7px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  border-radius: 8px !important;
}

.react-flow__controls-button svg {
  width: 15px !important;
  height: 15px !important;
}

.react-flow__controls {
  border-radius: 12px !important;
  overflow: hidden !important;
  gap: 2px !important;
  padding: 3px !important;
  box-shadow: 0 4px 16px rgba(0,0,0,0.10), 0 1px 4px rgba(0,0,0,0.06) !important;
  display: flex !important;
  flex-direction: column !important;
  border: 1px solid #e2e8f0 !important;
  background: #ffffff !important;
}

/* ReactFlow built-in controls panel — dark mode overrides */
.dark-mode .react-flow__controls {
  background-color: #1e1e1e !important;
  background: #1e1e1e !important;
  border-color: #3a3a3a !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.6) !important;
}

.dark-mode .react-flow__controls-button {
  background-color: #1e1e1e;
  border-color: #3a3a3a;
  color: #d4d4d4;
}

.dark-mode .react-flow__controls-button:hover {
  background-color: #2d2d2d;
}

.dark-mode .react-flow__controls-button svg {
  fill: #d4d4d4;
}

/* MiniMap */
.dark-mode .react-flow__minimap {
  background-color: #1e1e1e !important;
  border-color: #3a3a3a !important;
  box-shadow: 0 4px 16px rgba(0,0,0,0.5) !important;
}

.dark-mode .react-flow__minimap-mask {
  fill: rgba(0, 0, 0, 0.6);
}

/* ReactFlow edge labels */
.dark-mode .react-flow__edge-textbg {
  fill: #1e1e1e;
}

.dark-mode .react-flow__edge-text {
  fill: #d4d4d4;
}

/* ── Tailwind white / gray backgrounds → dark ── */
/* bg-white: raised clearly above the #0a0a0a canvas so panels/cards are visible */
.dark-mode .bg-white {
  background-color: #2a2a2a !important;
}

.dark-mode .bg-gray-50 {
  background-color: #232323 !important;
}

.dark-mode .bg-gray-100 {
  background-color: #2d2d2d !important;
}

/* Tailwind opacity-modified variants e.g. bg-gray-50/50 */
.dark-mode [class*="bg-gray-50"] {
  background-color: #232323 !important;
}

/* ── React-flow node wrappers – ensure the node bg shows through ── */
.dark-mode .react-flow__node {
  background: transparent !important;
}

/* ── Hover states ── */
.dark-mode .hover\:bg-gray-50:hover,
.dark-mode .hover\:bg-gray-100:hover {
  background-color: #2d2d2d !important;
}

/* ── Text: dark grays → light ── */
.dark-mode .text-gray-900,
.dark-mode .text-gray-800,
.dark-mode .text-gray-700,
.dark-mode .text-gray-600,
.dark-mode .text-black {
  color: #d4d4d4 !important;
}

.dark-mode .text-gray-500 {
  color: #aaaaaa !important;
}

.dark-mode .text-gray-400 {
  color: #888888 !important;
}

/* ── Borders ── */
.dark-mode .border-gray-100,
.dark-mode .border-gray-200,
.dark-mode .border-gray-300 {
  border-color: #3a3a3a !important;
}

/* ── Shadows ── */
.dark-mode .shadow-md,
.dark-mode .shadow-lg,
.dark-mode .shadow-xl,
.dark-mode .shadow-sm {
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.7) !important;
}

/* ── Form inputs ── */
.dark-mode input[type="text"],
.dark-mode textarea {
  background-color: #232323 !important;
  color: #d4d4d4 !important;
  border-color: #3a3a3a !important;
}

.dark-mode input[type="text"]::placeholder,
.dark-mode textarea::placeholder {
  color: #666666;
}

/* ── Prose / ReactMarkdown ── */
.dark-mode .prose {
  color: #d4d4d4;
}

.dark-mode .prose h1,
.dark-mode .prose h2,
.dark-mode .prose h3,
.dark-mode .prose h4,
.dark-mode .prose strong {
  color: #f0f0f0;
}

.dark-mode .prose a {
  color: #60a5fa;
}

.dark-mode .prose code {
  background-color: #2d2d2d;
  color: #d4d4d4;
}

.dark-mode .prose pre {
  background-color: #232323;
}

.dark-mode .prose blockquote {
  border-color: #3a3a3a;
  color: #aaa;
}

.dark-mode .prose hr {
  border-color: #3a3a3a;
}

.dark-mode .prose thead {
  border-color: #3a3a3a;
}

.dark-mode .prose tbody tr {
  border-color: #3a3a3a;
}

.dark-mode .prose thead th {
  color: #f0f0f0;
}

/* ── Yellow highlight block – soften for dark bg ── */
.dark-mode .bg-yellow-50 {
  background-color: #2a2500 !important;
}

/* ── Loading skeletons ── */
.dark-mode .animate-pulse {
  background-color: #2d2d2d !important;
}

/* ── Fixed top-corner UI buttons (Menu / Revision) ──
   These float over the canvas so they need clear contrast */
.dark-mode .fixed button.bg-white,
.dark-mode .fixed>button {
  background-color: #2a2a2a !important;
  color: #d4d4d4 !important;
  border-color: #444 !important;
}

/* Dropdown menus inside fixed panels */
.dark-mode .fixed .absolute.bg-white,
.dark-mode .fixed .absolute[class*="bg-white"] {
  background-color: #2a2a2a !important;
  border-color: #3a3a3a !important;
}

.dark-mode .fixed .absolute button {
  color: #d4d4d4 !important;
}

.dark-mode .fixed .absolute button:hover {
  background-color: #2d2d2d !important;
}

/* ── Whiteboard / Drawing ─────────────────────────────────────────────────── */

/* Text node styles */
.text-node-container {
  min-width: 60px;
  min-height: 24px;
  cursor: text;
}

.text-node-container textarea {
  background: transparent;
  resize: none;
  outline: none;
  border: 1.5px dashed #93c5fd;
  border-radius: 4px;
  padding: 4px 6px;
  font-family: inherit;
}

.text-node-container .text-display {
  padding: 4px 6px;
  white-space: pre-wrap;
  word-break: break-word;
}

/* Selected text node highlight */
.react-flow__node-textNode.selected .text-node-container {
  outline: 2px solid #3b82f6;
  outline-offset: 2px;
  border-radius: 4px;
}

/* Drawing toolbar dark mode */
.dark-mode .drawing-toolbar {
  background-color: #1e1e1e !important;
  border-color: #3a3a3a !important;
}

.dark-mode .drawing-toolbar button {
  color: #d4d4d4 !important;
}

.dark-mode .drawing-toolbar button:hover {
  background-color: #2d2d2d !important;
}

.dark-mode .drawing-toolbar .tool-panel {
  background-color: #1e1e1e !important;
  border-color: #3a3a3a !important;
}

/* Cursor styles when drawing tools are active */
.drawing-tool-pen {
  cursor: crosshair !important;
}

.drawing-tool-highlighter {
  cursor: crosshair !important;
}

.drawing-tool-text {
  cursor: text !important;
}

/* ── Save progress overlay — checkmark draw animation ─────────────────────── */
@keyframes draw-checkmark {
  to { stroke-dashoffset: 0; }
}

.save-checkmark-path {
  /* Total path length for points="14,25 21,32 35,17":
     segment 1: sqrt((21-14)²+(32-25)²) ≈ 9.9
     segment 2: sqrt((35-21)²+(17-32)²) ≈ 20.5  → total ≈ 31 */
  stroke-dasharray: 32;
  stroke-dashoffset: 32;
  animation: draw-checkmark 0.55s cubic-bezier(0.22, 0.61, 0.36, 1) 0.12s forwards;
}
